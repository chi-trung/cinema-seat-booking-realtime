<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cinema Booking - Äáº·t vÃ© xem phim Real-time</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Header -->
  <header>
    <div class="container">
      <div class="header-content">
        <div>
          <h1>ğŸ¬ Cinema Booking System</h1>
          <p class="subtitle">Äáº·t vÃ© xem phim Real-time + Database + Authentication</p>
        </div>
        <div id="user-section" style="display: none;" class="user-header">
          <div class="user-info">
            <span id="display-username"></span>
            <span id="display-role"></span>
          </div>
          <button onclick="logout()" class="btn-logout">ÄÄƒng xuáº¥t</button>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="container">
    <!-- ===== AUTHENTICATION SECTION ===== -->
    <section id="auth-section" class="card" style="display: none;">
      <div class="auth-container">
        <!-- Tab Navigation -->
        <div class="auth-tabs">
          <button class="auth-tab active" onclick="switchAuthTab('login')">ÄÄƒng nháº­p</button>
          <button class="auth-tab" onclick="switchAuthTab('register')">ÄÄƒng kÃ½</button>
        </div>

        <!-- Login Tab -->
        <div id="login-tab" class="auth-form active">
          <h2>ÄÄƒng nháº­p tÃ i khoáº£n</h2>
          <div class="form-group">
            <label>TÃªn Ä‘Äƒng nháº­p:</label>
            <input type="text" id="login-username" placeholder="admin hoáº·c user1" />
          </div>
          <div class="form-group">
            <label>Máº­t kháº©u:</label>
            <input type="password" id="login-password" placeholder="admin123 hoáº·c user123" />
          </div>
          <button onclick="login()" class="btn-primary">ÄÄƒng nháº­p</button>
          <p class="hint">ğŸ’¡ TÃ i khoáº£n máº·c Ä‘á»‹nh: admin/admin123 hoáº·c user1/user123</p>
        </div>

        <!-- Register Tab -->
        <div id="register-tab" class="auth-form">
          <h2>Táº¡o tÃ i khoáº£n má»›i</h2>
          <div class="form-group">
            <label>TÃªn Ä‘Äƒng nháº­p:</label>
            <input type="text" id="register-username" placeholder="Nháº­p tÃªn Ä‘Äƒng nháº­p" />
          </div>
          <div class="form-group">
            <label>Email:</label>
            <input type="email" id="register-email" placeholder="Nháº­p email" />
          </div>
          <div class="form-group">
            <label>Máº­t kháº©u (tá»‘i thiá»ƒu 6 kÃ½ tá»±):</label>
            <input type="password" id="register-password" placeholder="Nháº­p máº­t kháº©u" />
          </div>
          <button onclick="register()" class="btn-primary">ÄÄƒng kÃ½</button>
        </div>
      </div>
    </section>

    <!-- ===== ADMIN UPLOAD SECTION ===== -->
    <section id="admin-section" class="card" style="display: none;">
      <h2>ğŸ‘¨â€ğŸ’¼ Quáº£n lÃ½ phim (Admin)</h2>
      <div class="admin-form">
        <h3>Upload phim má»›i</h3>
        <div class="form-group">
          <label>TÃªn phim:</label>
          <input type="text" id="upload-title" placeholder="Nháº­p tÃªn phim" />
        </div>
        <div class="form-group">
          <label>MÃ´ táº£:</label>
          <textarea id="upload-description" placeholder="MÃ´ táº£ phim" rows="2"></textarea>
        </div>
        <div class="form-row">
          <div class="form-group" style="flex: 1;">
            <label>NgÃ y chiáº¿u:</label>
            <input type="date" id="upload-date" />
          </div>
          <div class="form-group" style="flex: 1;">
            <label>Giá» chiáº¿u:</label>
            <input type="time" id="upload-time" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group" style="flex: 1;">
            <label>Ráº¡p:</label>
            <input type="text" id="upload-theater" placeholder="Ráº¡p 1, 2, 3..." />
          </div>
          <div class="form-group" style="flex: 1;">
            <label>GiÃ¡ vÃ© (VNÄ):</label>
            <input type="number" id="upload-price" placeholder="100000" />
          </div>
        </div>
        <div class="form-group">
          <label>Poster (áº£nh):</label>
          <input type="file" id="upload-poster" accept="image/*" />
          <small>Há»— trá»£ JPG, PNG, WEBP (tá»‘i Ä‘a 5MB)</small>
        </div>
        <button onclick="uploadMovie()" class="btn-primary">Upload phim</button>
      </div>
    </section>

    <!-- ===== CONNECTION STATUS ===== -->
    <div id="connection-status" class="status-bar">
      <span id="status-indicator">âšª</span>
      <span id="status-text">ChÆ°a káº¿t ná»‘i</span>
    </div>

    <!-- ===== MOVIES LIST SECTION ===== -->
    <section id="movies-section" class="card" style="display: none;">
      <h2>ğŸ¥ Danh sÃ¡ch phim</h2>
      <div id="movies-list" class="movies-grid"></div>
    </section>

    <!-- ===== SEAT SELECTION SECTION ===== -->
    <section id="seats-section" class="card" style="display: none;">
      <div class="seat-header">
        <div>
          <h2 id="selected-movie-title"></h2>
          <p id="selected-movie-info"></p>
        </div>
        <button onclick="goBackToMovies()" class="btn-secondary">â† Quay láº¡i</button>
      </div>

      <div class="screen">ğŸ¬ MÃ€N HÃŒNH ğŸ¬</div>

      <div id="seats-container" class="seats-container"></div>

      <div class="legend">
        <div class="legend-item">
          <div class="seat available"></div>
          <span>Trá»‘ng</span>
        </div>
        <div class="legend-item">
          <div class="seat selected"></div>
          <span>Äang chá»n (báº¡n)</span>
        </div>
        <div class="legend-item">
          <div class="seat booked"></div>
          <span>ÄÃ£ Ä‘áº·t</span>
        </div>
      </div>

      <div class="booking-info">
        <div class="booking-summary">
          <p>Gháº¿ Ä‘Ã£ chá»n: <strong id="selected-count">0</strong> | Tá»•ng tiá»n: <strong id="total-price">0 VNÄ</strong></p>
          <button onclick="confirmBooking()" class="btn-primary" id="confirm-btn" disabled>XÃ¡c nháº­n Ä‘áº·t vÃ©</button>
        </div>
      </div>
    </section>

    <!-- ===== ACTIVITY LOG ===== -->
    <section class="card">
      <h2>ğŸ“Š Hoáº¡t Ä‘á»™ng Real-time</h2>
      <div id="logs" class="logs-container"></div>
    </section>
  </main>

  <!-- Footer -->
  <footer>
    <div class="container">
      <p>ğŸ“ Dá»± Ã¡n mÃ´n Láº­p trÃ¬nh máº¡ng - Há»‡ thá»‘ng Ä‘áº·t vÃ© xem phim Real-time</p>
      <p>KhÃ¡i niá»‡m: Client-Server | HTTP REST API | JWT Auth | WebSocket | SQLite Database</p>
    </div>
  </footer>

  <!-- Socket.IO Client Library -->
  <script src="/socket.io/socket.io.js"></script>
  <!-- Main App Script -->
  <script src="app.js"></script>

  <script>
    // Tab switching for auth
    function switchAuthTab(tab) {
      const tabs = document.querySelectorAll('.auth-tab');
      const forms = document.querySelectorAll('.auth-form');

      tabs.forEach(t => t.classList.remove('active'));
      forms.forEach(f => f.classList.remove('active'));

      event.target.classList.add('active');
      document.getElementById(tab + '-tab').classList.add('active');
    }

    // Auto-enable/disable confirm button
    function updateConfirmButton() {
      const btn = document.getElementById('confirm-btn');
      if (btn) {
        btn.disabled = selectedSeats.size === 0;
      }
    }

    // Override toggleSeat to update button
    const originalToggleSeat = toggleSeat;
    toggleSeat = function(seatId, status) {
      originalToggleSeat.call(this, seatId, status);
      updateConfirmButton();
    };
  </script>
</body>
</html>
